---
import "../styles/global.css";

interface Props {
  title?: string;
  description?: string;
}

const {
  title = "HighlandXR",
  description = "Connecting XR events, talent, and funding across the Scottish Highlands."
} = Astro.props;

const pageTitle = `${title} | HighlandXR`;
const pathname = Astro.url.pathname;
const currentYear = new Date().getFullYear();

const navItems = [
  { href: "/", label: "Home" },
  { href: "/events", label: "Events" },
  { href: "/directory", label: "Directory" },
  { href: "/funding", label: "Funding" }
];

const isActive = (href: string) => {
  if (href === "/") return pathname === "/";
  return pathname.startsWith(href);
};
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content={description} />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="alternate" type="application/rss+xml" title="HighlandXR Events RSS" href="/rss.xml" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Sora:wght@600;700&family=Space+Grotesk:wght@500;600;700&display=swap"
    />
    <title>{pageTitle}</title>
  </head>
  <body>
    <a
      class="absolute left-3 top-[-70px] z-50 rounded-pill border border-white/25 bg-surface-panel px-3 py-2 text-sm text-text-base no-underline transition-all duration-200 focus:top-3"
      href="#main-content"
    >
      Skip to content
    </a>

    <div class="grid min-h-screen grid-rows-[auto_1fr_auto]">
      <header class="sticky top-0 z-40 border-b border-white/10 bg-surface-deep/80 backdrop-blur-xl">
        <div class="shell-container flex flex-wrap items-center gap-3 py-3">
          <a href="/" class="inline-flex items-center gap-2 text-text-base no-underline" aria-label="HighlandXR home">
            <span
              aria-hidden="true"
              class="h-3.5 w-3.5 rounded-full bg-gradient-to-br from-brand-aurora to-brand-violet shadow-[0_0_18px_rgba(92,227,215,0.45)]"
            >
            </span>
            <span class="font-heading text-lg tracking-wide">Highland XR</span>
          </a>

          <nav class="ml-auto" aria-label="Main">
            <ul class="m-0 flex list-none flex-wrap items-center gap-1 p-0">
              {
                navItems.map((item) => (
                  <li>
                    <a
                      href={item.href}
                      class={`inline-flex rounded-pill border px-3 py-1.5 text-sm font-medium no-underline transition-all duration-200 ${
                        isActive(item.href)
                          ? "border-brand-aurora/50 bg-brand-aurora/15 text-text-base"
                          : "border-transparent text-text-muted hover:border-white/20 hover:bg-white/[0.04] hover:text-text-base"
                      }`}
                      aria-current={isActive(item.href) ? "page" : undefined}
                    >
                      {item.label}
                    </a>
                  </li>
                ))
              }
            </ul>
          </nav>

          <a
            href="/submit"
            class={`btn ${pathname.startsWith("/submit") ? "btn-secondary" : "btn-primary"} shrink-0`}
            aria-current={pathname.startsWith("/submit") ? "page" : undefined}
          >
            Submit an Event
          </a>
        </div>
      </header>

      <main id="main-content" class="shell-container pb-20 pt-8 md:pt-10">
        <slot />
      </main>

      <footer class="mt-12 border-t border-white/10 bg-surface-charcoal/70">
        <div aria-hidden="true" class="h-10 w-full border-b border-white/10 opacity-70">
          <svg viewBox="0 0 1200 120" class="h-full w-full" preserveAspectRatio="none">
            <path
              d="M0,86 C115,28 240,26 356,72 C467,116 584,113 710,71 C844,26 970,30 1200,88 L1200,120 L0,120 Z"
              fill="rgba(141,187,156,0.2)"
            />
            <path
              d="M0,94 C140,52 278,52 406,87 C523,118 630,114 760,83 C915,45 1035,47 1200,92"
              fill="none"
              stroke="rgba(92,227,215,0.25)"
              stroke-width="1.2"
            />
          </svg>
        </div>

        <div class="shell-container grid gap-8 py-10 md:grid-cols-[1.2fr_0.9fr_1fr]">
          <section class="grid gap-3">
            <h2 class="text-lg">Highland XR</h2>
            <p class="max-w-md text-sm text-text-muted">
              The XR hub for the Scottish Highlands, connecting events, people, projects, and opportunities.
            </p>
          </section>

          <nav aria-label="Footer navigation" class="grid content-start gap-2">
            <p class="text-xs font-semibold uppercase tracking-[0.14em] text-text-subtle">Navigation</p>
            <ul class="m-0 grid list-none gap-2 p-0 text-sm">
              <li><a href="/" class="no-underline">Home</a></li>
              <li><a href="/events" class="no-underline">Events</a></li>
              <li><a href="/directory" class="no-underline">Directory</a></li>
              <li><a href="/funding" class="no-underline">Funding</a></li>
              <li><a href="/rss.xml" class="no-underline">Events RSS</a></li>
            </ul>
          </nav>

          <section class="surface-panel-soft grid gap-3 p-5">
            <p class="text-xs font-semibold uppercase tracking-[0.14em] text-text-subtle">Contribute</p>
            <p class="text-sm text-text-muted">
              Hosting an event or offering an opportunity? Publish it for the Highland XR community.
            </p>
            <div>
              <a class="btn btn-secondary" href="/submit">Submit an Event</a>
            </div>
          </section>
        </div>

        <div class="shell-container border-t border-white/10 py-4">
          <p class="text-xs text-text-subtle">Copyright {currentYear} HighlandXR</p>
        </div>
      </footer>
    </div>
  </body>
</html>
